name: PR Debug - Weekly Update Test
on:
  pull_request:
    types: [opened, synchronize, reopened]
    branches: [main, master]
  pull_request_target:
    types: [opened, synchronize, reopened] 
    branches: [main, master]
  workflow_dispatch:
    inputs:
      pr_number:
        description: 'PR Î≤àÌò∏ (ÏÑ†ÌÉùÏÇ¨Ìï≠)'
        required: false
        type: string
      force_reset:
        description: 'Í∞ïÏ†ú Î¶¨ÏÖã'
        required: false
        default: true
        type: boolean
      notification:
        description: 'ÏïåÎ¶º Ï†ÑÏÜ° Ïó¨Î∂Ä'
        required: false
        default: false
        type: boolean

env:
  TZ: Asia/Seoul
  DEBUG_MODE: true
  FORCE_RESET: true

jobs:
  pr-debug-test:
    runs-on: ubuntu-latest
    steps:
      - name: PR Debug Info
        run: |
          echo "üî• PR DEBUG: README ÏóÖÎç∞Ïù¥Ìä∏ ÌÖåÏä§Ìä∏ ÏûêÎèô Ïã§Ìñâ"
          echo "‚è∞ Ïã§Ìñâ ÏãúÍ∞Ñ: $(date '+%Y-%m-%d %H:%M:%S KST')"
          echo "üîß Ìä∏Î¶¨Í±∞: ${{ github.event_name }}"
          if [ "${{ github.event_name }}" = "pull_request" ] || [ "${{ github.event_name }}" = "pull_request_target" ]; then
            echo "üìù PR Î≤àÌò∏: #${{ github.event.number }}"
            echo "üë§ PR ÏûëÏÑ±Ïûê: ${{ github.event.pull_request.user.login }}"
            echo "üåø Î∏åÎûúÏπò: ${{ github.event.pull_request.head.ref }}"
            echo "üìÑ Ï†úÎ™©: ${{ github.event.pull_request.title }}"
          fi
          echo "üë§ Ïã§ÌñâÏûê: ${{ github.actor }}"
          
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0
          # PRÏù∏ Í≤ΩÏö∞ Ìï¥Îãπ Î∏åÎûúÏπòÎ•º Ï≤¥ÌÅ¨ÏïÑÏõÉ
          ref: ${{ github.event_name == 'pull_request' && github.event.pull_request.head.sha || github.sha }}
          
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.9"
          
      - name: Install dependencies
        run: |
          pip install requests pytz
          echo "üì¶ ÏùòÏ°¥ÏÑ± ÏÑ§Ïπò ÏôÑÎ£å"
          
      - name: Debug - Check PR context
        if: github.event_name == 'pull_request' || github.event_name == 'pull_request_target'
        run: |
          echo "üìã PR Ïª®ÌÖçÏä§Ìä∏ Ï†ïÎ≥¥:"
          echo "  - PR Î≤àÌò∏: #${{ github.event.number }}"
          echo "  - ÏûëÏÑ±Ïûê: ${{ github.event.pull_request.user.login }}"
          echo "  - Î∏åÎûúÏπò: ${{ github.event.pull_request.head.ref }}"
          echo "  - Ïª§Î∞ã SHA: ${{ github.event.pull_request.head.sha }}"
          echo "  - Í∏∞Î≥∏ Î∏åÎûúÏπò: ${{ github.event.pull_request.base.ref }}"
          echo "  - ÏÉÅÌÉú: ${{ github.event.action }}"
          
      - name: Debug - Check files structure
        run: |
          echo "üìÅ ÌååÏùº Íµ¨Ï°∞ ÌôïÏù∏:"
          echo "=== Root Directory ==="
          ls -la
          echo ""
          echo "=== Scripts Directory ==="
          if [ -d "scripts" ]; then
            ls -la scripts/
          else
            echo "‚ùå scripts ÎîîÎ†âÌÜ†Î¶¨ ÏóÜÏùå"
          fi
          echo ""
          echo "=== Python Scripts Check ==="
          for script in scripts/check_session.py scripts/send_notification.py scripts/create_debug_readme.py; do
            if [ -f "$script" ]; then
              echo "‚úÖ $script Ï°¥Ïû¨"
            else
              echo "‚ùå $script ÏóÜÏùå"
            fi
          done
          
      - name: Check current session info using script
        id: session_check
        run: |
          echo "üîç ÌöåÏ∞® Ï†ïÎ≥¥ ÌôïÏù∏ Ï§ë (PR ÎîîÎ≤ÑÍ∑∏ Î™®Îìú)..."
          
          # check_session.pyÍ∞Ä ÏûàÎäîÏßÄ ÌôïÏù∏ÌïòÍ≥† Ïã§Ìñâ
          if [ -f "scripts/check_session.py" ]; then
            echo "üìù scripts/check_session.py Ïã§Ìñâ Ï§ë..."
            
            cd scripts
            RESULT=$(python check_session.py 2>&1)
            cd ..
            
            echo "üìã Ïä§ÌÅ¨Î¶ΩÌä∏ Ïã§Ìñâ Í≤∞Í≥º:"
            echo "$RESULT"
            
            # Í≤∞Í≥ºÎ•º ÌôòÍ≤ΩÎ≥ÄÏàòÎ°ú ÏÑ§Ï†ï
            echo "$RESULT" | grep "=" >> $GITHUB_ENV
            
            echo "‚úÖ check_session.py Ïã§Ìñâ ÏôÑÎ£å"
          else
            echo "‚ùå scripts/check_session.py ÏóÜÏùå - PR ÎîîÎ≤ÑÍ∑∏ Ìè¥Î∞± Î™®Îìú"
            
            # PR ÎîîÎ≤ÑÍ∑∏Ïö© Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï
            TODAY=$(date '+%Y-%m-%d')
            WEEK_END=$(date -d '+6 days' '+%Y-%m-%d')
            PR_NUM="${{ github.event.number || 'manual' }}"
            
            echo "IS_NEW_WEEK=true" >> $GITHUB_ENV
            echo "SESSION_NUMBER=PR${PR_NUM}" >> $GITHUB_ENV
            echo "TODAY=$TODAY" >> $GITHUB_ENV
            echo "WEEK_START=$TODAY" >> $GITHUB_ENV
            echo "WEEK_END=$WEEK_END" >> $GITHUB_ENV
            echo "DEADLINE=$WEEK_END 23:59" >> $GITHUB_ENV
            echo "HAS_SESSION_COUNTER=false" >> $GITHUB_ENV
            echo "TOTAL_WEEKS=0" >> $GITHUB_ENV
            echo "TOTAL_DAYS=0" >> $GITHUB_ENV
            echo "STUDY_START=$TODAY" >> $GITHUB_ENV
          fi
          
      - name: Debug - Show environment variables
        run: |
          echo "üêõ ÌôòÍ≤Ω Î≥ÄÏàò ÌôïÏù∏ (PR ÎîîÎ≤ÑÍ∑∏):"
          echo "  IS_NEW_WEEK: $IS_NEW_WEEK"
          echo "  FORCE_RESET: $FORCE_RESET"
          echo "  SESSION_NUMBER: $SESSION_NUMBER"
          echo "  TODAY: $TODAY"
          echo "  WEEK_START: $WEEK_START"
          echo "  WEEK_END: $WEEK_END"
          echo "  DEADLINE: $DEADLINE"
          echo "  HAS_SESSION_COUNTER: $HAS_SESSION_COUNTER"
          echo "  TOTAL_WEEKS: $TOTAL_WEEKS"
          echo "  TOTAL_DAYS: $TOTAL_DAYS"
          
      - name: Create test README backup
        run: |
          if [ -f "README.md" ]; then
            BACKUP_NAME="README_pr_debug_backup_$(date +%Y%m%d_%H%M%S).md"
            cp README.md "$BACKUP_NAME"
            echo "üìÅ PR ÎîîÎ≤ÑÍ∑∏ Î∞±ÏóÖ ÏÉùÏÑ±: $BACKUP_NAME"
            echo "BACKUP_FILE=$BACKUP_NAME" >> $GITHUB_ENV
          else
            echo "‚ÑπÔ∏è Í∏∞Ï°¥ README.md ÏóÜÏùå"
          fi
          
      - name: Generate test README using script
        run: |
          echo "üîÑ ÌÖåÏä§Ìä∏ README ÏÉùÏÑ± Ï§ë (PR ÎîîÎ≤ÑÍ∑∏)..."
          
          if [ -f "scripts/create_debug_readme.py" ]; then
            echo "üìù scripts/create_debug_readme.py Ïã§Ìñâ Ï§ë..."
            
            cd scripts
            python create_debug_readme.py --debug-mode --try-advanced
            cd ..
            
            if [ $? -eq 0 ]; then
              echo "‚úÖ Ïä§ÌÅ¨Î¶ΩÌä∏Î•º ÌÜµÌïú README ÏÉùÏÑ± ÏÑ±Í≥µ"
              echo "UPDATE_SUCCESS=true" >> $GITHUB_ENV
            else
              echo "‚ùå Ïä§ÌÅ¨Î¶ΩÌä∏Î•º ÌÜµÌïú README ÏÉùÏÑ± Ïã§Ìå®"
              echo "UPDATE_SUCCESS=false" >> $GITHUB_ENV
            fi
          else
            echo "‚ùå scripts/create_debug_readme.py ÏóÜÏùå - PR ÎîîÎ≤ÑÍ∑∏ Ìè¥Î∞± README ÏÉùÏÑ±"
            
            # PR ÎîîÎ≤ÑÍ∑∏Ïö© README ÏÉùÏÑ±
            PR_NUM="${{ github.event.number || 'manual' }}"
            PR_AUTHOR="${{ github.event.pull_request.user.login || github.actor }}"
            PR_TITLE="${{ github.event.pull_request.title || 'Manual Test' }}"
            
            echo "# üöÄ ÏïåÍ≥†Î¶¨Ï¶ò Ïä§ÌÑ∞Îîî (PR #${PR_NUM} Debug Test)" > README.md
            echo "" >> README.md
            echo "## üìÖ PR${PR_NUM}ÌöåÏ∞® ÌòÑÌô© (ÌÖåÏä§Ìä∏)" >> README.md
            echo "**Í∏∞Í∞Ñ**: ${WEEK_START} ~ ${WEEK_END}" >> README.md
            echo "**ÎßàÍ∞ê**: ${DEADLINE}" >> README.md
            echo "" >> README.md
            echo "### üî• PR ÎîîÎ≤ÑÍ∑∏ Î™®ÎìúÎ°ú Ïã§ÌñâÎê®" >> README.md
            echo "" >> README.md
            echo "Ïù¥ READMEÎäî PRÏóê ÏùòÌï¥ ÏûêÎèôÏúºÎ°ú ÏÉùÏÑ±Îêú ÌÖåÏä§Ìä∏ Î≤ÑÏ†ÑÏûÖÎãàÎã§." >> README.md
            echo "" >> README.md
            echo "### üêõ PR ÎîîÎ≤ÑÍ∑∏ Ï†ïÎ≥¥" >> README.md
            echo "- **Ïã§Ìñâ ÏãúÍ∞Ñ**: $(date '+%Y-%m-%d %H:%M:%S KST')" >> README.md
            echo "- **PR Î≤àÌò∏**: #${PR_NUM}" >> README.md
            echo "- **PR ÏûëÏÑ±Ïûê**: ${PR_AUTHOR}" >> README.md
            echo "- **PR Ï†úÎ™©**: ${PR_TITLE}" >> README.md
            echo "- **Ìä∏Î¶¨Í±∞**: ${{ github.event_name }}" >> README.md
            echo "- **Ïã§ÌñâÏûê**: ${{ github.actor }}" >> README.md
            echo "- **ÌöåÏ∞®**: ${SESSION_NUMBER}ÌöåÏ∞® (DEBUG)" >> README.md
            echo "" >> README.md
            echo "### Ï†úÏ∂ú ÌòÑÌô© (ÌÖåÏä§Ìä∏)" >> README.md
            echo "" >> README.md
            echo "| Ï∞∏Í∞ÄÏûê | Ïõî | Ìôî | Ïàò | Î™© | Í∏à | ÌÜ† | Ïùº |" >> README.md
            echo "|--------|----|----|----|----|----|----|---|" >> README.md
            echo "| pr_test_user | 1000 | 1001 | 1002 | | | | |" >> README.md
            echo "| ${PR_AUTHOR} | 2557 | | | | | | |" >> README.md
            echo "" >> README.md
            echo "## ü§ñ ÏûêÎèôÌôî ÏãúÏä§ÌÖú ÏÜåÍ∞ú" >> README.md
            echo "" >> README.md
            echo "### üîß Ï£ºÏöî Í∏∞Îä•" >> README.md
            echo "- **ÏûêÎèô ÌÖåÏä§Ìä∏**: ÏÉòÌîå ÌÖåÏä§Ìä∏ÏºÄÏù¥Ïä§ + AI ÏÉùÏÑ± Î∞òÎ°Ä ÌÖåÏä§Ìä∏" >> README.md
            echo "- **Ïä§ÎßàÌä∏ Ï±ÑÏ†ê**: Î∂ÄÎ∂Ñ Ï†êÏàò ÏßÄÏõê (ÏÉòÌîåÎßå/ÏÉùÏÑ± ÌÖåÏä§Ìä∏Îßå ÌÜµÍ≥º)" >> README.md
            echo "- **Í∞úÏù∏ ÏïåÎ¶º**: Mattermost Í∞úÏù∏ DMÏúºÎ°ú Í≤∞Í≥º ÌÜµÁü•" >> README.md
            echo "- **ÏûêÎèô README ÏóÖÎç∞Ïù¥Ìä∏**: Ï†úÏ∂ú ÌòÑÌô© Ïã§ÏãúÍ∞Ñ Î∞òÏòÅ" >> README.md
            echo "- **PR ÎîîÎ≤ÑÍ∑∏**: PR ÏÉùÏÑ± Ïãú ÏûêÎèô ÌÖåÏä§Ìä∏ Ïã§Ìñâ" >> README.md
            echo "" >> README.md
            echo "---" >> README.md
            echo "*Auto-updated by GitHub Actions ü§ñ (PR #${PR_NUM} Debug Mode)*" >> README.md
            
            echo "‚úÖ PR ÎîîÎ≤ÑÍ∑∏ README ÏÉùÏÑ± ÏôÑÎ£å"
            echo "UPDATE_SUCCESS=true" >> $GITHUB_ENV
          fi
          
      - name: Debug - Show generated README
        run: |
          echo "üìÑ ÏÉùÏÑ±Îêú README.md ÎÇ¥Ïö© (Ï≤´ 40Ï§Ñ):"
          echo "================================================"
          head -40 README.md
          echo "================================================"
          echo "(Ï¥ù $(wc -l < README.md) Ï§Ñ, $(stat -c%s README.md) bytes)"
          
      - name: Test commit simulation (DRY RUN)
        if: env.UPDATE_SUCCESS == 'true'
        run: |
          echo "üß™ Ïª§Î∞ã ÏãúÎÆ¨Î†àÏù¥ÏÖò (Ïã§Ï†ú Ïª§Î∞ãÌïòÏßÄ ÏïäÏùå)..."
          
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action - PR Debug"
          
          # Î≥ÄÍ≤ΩÎêú ÌååÏùºÎì§ ÌôïÏù∏
          git add README.md
          git add $BACKUP_FILE 2>/dev/null || true
          
          if git diff --staged --quiet; then
            echo "üìù Î≥ÄÍ≤Ω ÏÇ¨Ìï≠Ïù¥ ÏóÜÏäµÎãàÎã§."
            echo "WOULD_COMMIT=false" >> $GITHUB_ENV
          else
            echo "üìù Ïª§Î∞ãÌï† Î≥ÄÍ≤ΩÏÇ¨Ìï≠Ïù¥ ÏûàÏäµÎãàÎã§:"
            git diff --staged --name-only
            echo ""
            echo "üìÑ Î≥ÄÍ≤Ω ÎÇ¥Ïö© ÎØ∏Î¶¨Î≥¥Í∏∞:"
            git diff --staged README.md | head -20
            echo "WOULD_COMMIT=true" >> $GITHUB_ENV
            
            # Ïã§Ï†úÎ°úÎäî Ïª§Î∞ãÌïòÏßÄ ÏïäÏùå (PR ÎîîÎ≤ÑÍ∑∏ Î™®Îìú)
            echo "‚ÑπÔ∏è PR ÎîîÎ≤ÑÍ∑∏ Î™®ÎìúÏóêÏÑúÎäî Ïã§Ï†ú Ïª§Î∞ãÏùÑ ÌïòÏßÄ ÏïäÏäµÎãàÎã§."
          fi
          
      - name: Test notification simulation
        if: env.WOULD_COMMIT == 'true'
        env:
          YEOMIN4242_MATTERMOST_URL: ${{ secrets.YEOMIN4242_MATTERMOST_URL }}
        run: |
          echo "üì¢ ÏïåÎ¶º ÏãúÎÆ¨Î†àÏù¥ÏÖò (PR ÎîîÎ≤ÑÍ∑∏)..."
          
          if [ -f "scripts/send_notification.py" ]; then
            echo "üì® scripts/send_notification.py ÌÖåÏä§Ìä∏ Ïã§Ìñâ..."
            
            cd scripts
            python send_notification.py --debug-mode --dry-run
            cd ..
            
            echo "‚úÖ ÏïåÎ¶º Ïä§ÌÅ¨Î¶ΩÌä∏ ÌÖåÏä§Ìä∏ ÏôÑÎ£å"
          else
            echo "‚ùå scripts/send_notification.py ÏóÜÏùå - ÏïåÎ¶º ÏãúÎÆ¨Î†àÏù¥ÏÖò"
            
            if [ -n "$YEOMIN4242_MATTERMOST_URL" ]; then
              echo "üìù Ï†ÑÏÜ°Îê† ÏïåÎ¶º ÎÇ¥Ïö© ÎØ∏Î¶¨Î≥¥Í∏∞:"
              echo "=================================="
              PR_NUM="${{ github.event.number || 'manual' }}"
              echo "üî• **PR #${PR_NUM} DEBUG: README ÏóÖÎç∞Ïù¥Ìä∏ ÌÖåÏä§Ìä∏**"
              echo ""
              echo "‚è∞ ÏãúÍ∞Ñ: $(date '+%Y-%m-%d %H:%M:%S KST')"
              echo "üéØ ÌöåÏ∞®: ${SESSION_NUMBER}ÌöåÏ∞® (PR ÎîîÎ≤ÑÍ∑∏)"
              echo "üë§ PR ÏûëÏÑ±Ïûê: ${{ github.event.pull_request.user.login || github.actor }}"
              echo "üåø Î∏åÎûúÏπò: ${{ github.event.pull_request.head.ref || 'manual' }}"
              echo "ü§ñ Ìä∏Î¶¨Í±∞: ${{ github.event_name }}"
              echo ""
              echo "‚ö†Ô∏è Ïù¥Í≤ÉÏùÄ PRÏóê ÏùòÌï¥ ÏûêÎèô Ïã§ÌñâÎêú ÌÖåÏä§Ìä∏ÏûÖÎãàÎã§."
              echo "=================================="
            else
              echo "‚ö†Ô∏è Mattermost webhook URLÏù¥ ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏùå"
            fi
          fi
          
      - name: Add PR comment
        if: (github.event_name == 'pull_request' || github.event_name == 'pull_request_target') && env.UPDATE_SUCCESS == 'true'
        uses: actions/github-script@v6
        with:
          script: |
            const prNumber = context.payload.number;
            const sessionNumber = process.env.SESSION_NUMBER;
            const updateSuccess = process.env.UPDATE_SUCCESS;
            const wouldCommit = process.env.WOULD_COMMIT;
            
            const comment = `## üî• PR ÎîîÎ≤ÑÍ∑∏: README ÏóÖÎç∞Ïù¥Ìä∏ ÌÖåÏä§Ìä∏ Í≤∞Í≥º
            
            **‚è∞ Ïã§Ìñâ ÏãúÍ∞Ñ**: ${new Date().toLocaleString('ko-KR', {timeZone: 'Asia/Seoul'})} KST
            **üéØ ÌÖåÏä§Ìä∏ ÌöåÏ∞®**: ${sessionNumber}ÌöåÏ∞® (PR ÎîîÎ≤ÑÍ∑∏)
            **üìù README ÏÉùÏÑ±**: ${updateSuccess === 'true' ? '‚úÖ ÏÑ±Í≥µ' : '‚ùå Ïã§Ìå®'}
            **üíæ Ïª§Î∞ã ÌïÑÏöîÏÑ±**: ${wouldCommit === 'true' ? '‚úÖ Î≥ÄÍ≤ΩÏÇ¨Ìï≠ ÏûàÏùå' : '‚ÑπÔ∏è Î≥ÄÍ≤ΩÏÇ¨Ìï≠ ÏóÜÏùå'}
            
            ### üìã ÌÖåÏä§Ìä∏ ÎÇ¥Ïö©
            - README.md ÏûêÎèô ÏÉùÏÑ± ÌÖåÏä§Ìä∏
            - ÌöåÏ∞® Ï†ïÎ≥¥ Í≥ÑÏÇ∞ ÌÖåÏä§Ìä∏  
            - Ïä§ÌÅ¨Î¶ΩÌä∏ ÌååÏùº Ï°¥Ïû¨ Ïó¨Î∂Ä ÌôïÏù∏
            - ÏïåÎ¶º ÏãúÏä§ÌÖú ÌÖåÏä§Ìä∏ (ÏãúÎÆ¨Î†àÏù¥ÏÖò)
            
            ### üîß Ïä§ÌÅ¨Î¶ΩÌä∏ ÏÉÅÌÉú
            ${process.env.HAS_SESSION_COUNTER === 'true' ? '‚úÖ' : '‚ùå'} session_counter.py
            ${require('fs').existsSync('scripts/create_debug_readme.py') ? '‚úÖ' : '‚ùå'} create_debug_readme.py  
            ${require('fs').existsSync('scripts/send_notification.py') ? '‚úÖ' : '‚ùå'} send_notification.py
            
            > üí° **Ï∞∏Í≥†**: Ïù¥Í≤ÉÏùÄ PRÏóê ÏùòÌï¥ ÏûêÎèô Ïã§ÌñâÎêú ÌÖåÏä§Ìä∏ÏûÖÎãàÎã§. Ïã§Ï†ú main Î∏åÎûúÏπòÎäî Î≥ÄÍ≤ΩÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.
            
            ---
            *ü§ñ GitHub ActionsÏóêÏÑú ÏûêÎèô ÏÉùÏÑ±Îêú ÎåìÍ∏Ä*`;
            
            github.rest.issues.createComment({
              issue_number: prNumber,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: comment
            });
            
      - name: PR Debug summary
        if: always()
        run: |
          echo "## üî• PR Debug Weekly Update Ïã§Ìñâ Í≤∞Í≥º" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**‚ö†Ô∏è Ï£ºÏùò: Ïù¥Í≤ÉÏùÄ PRÏóê ÏùòÌï¥ ÏûêÎèô Ïã§ÌñâÎêú ÎîîÎ≤ÑÍ∑∏ ÌÖåÏä§Ìä∏ÏûÖÎãàÎã§**" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Ïã§Ìñâ ÏãúÍ∞Ñ**: $(date '+%Y-%m-%d %H:%M:%S KST')" >> $GITHUB_STEP_SUMMARY
          echo "**Ìä∏Î¶¨Í±∞**: ${{ github.event_name }}" >> $GITHUB_STEP_SUMMARY
          
          if [ "${{ github.event_name }}" = "pull_request" ] || [ "${{ github.event_name }}" = "pull_request_target" ]; then
            echo "**PR Î≤àÌò∏**: #${{ github.event.number }}" >> $GITHUB_STEP_SUMMARY
            echo "**PR ÏûëÏÑ±Ïûê**: ${{ github.event.pull_request.user.login }}" >> $GITHUB_STEP_SUMMARY
            echo "**Î∏åÎûúÏπò**: ${{ github.event.pull_request.head.ref }}" >> $GITHUB_STEP_SUMMARY
          fi
          
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### üìä ÌÖåÏä§Ìä∏ Ï†ïÎ≥¥" >> $GITHUB_STEP_SUMMARY
          echo "- **ÌÖåÏä§Ìä∏ ÌöåÏ∞®**: ${SESSION_NUMBER}ÌöåÏ∞® (PR ÎîîÎ≤ÑÍ∑∏)" >> $GITHUB_STEP_SUMMARY
          echo "- **ÎÇ†Ïßú**: ${TODAY}" >> $GITHUB_STEP_SUMMARY
          echo "- **Ï£ºÏ∞®**: ${WEEK_START} ~ ${WEEK_END}" >> $GITHUB_STEP_SUMMARY
          echo "- **Session Counter**: ${HAS_SESSION_COUNTER}" >> $GITHUB_STEP_SUMMARY
          
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### üìù Ïä§ÌÅ¨Î¶ΩÌä∏ ÌÖåÏä§Ìä∏ Í≤∞Í≥º" >> $GITHUB_STEP_SUMMARY
          
          for script in check_session.py send_notification.py create_debug_readme.py; do
            if [ -f "scripts/$script" ]; then
              echo "‚úÖ **$script**: ÏÇ¨Ïö© Í∞ÄÎä•" >> $GITHUB_STEP_SUMMARY
            else
              echo "‚ùå **$script**: ÏóÜÏùå (Ìè¥Î∞± Î™®Îìú ÏÇ¨Ïö©)" >> $GITHUB_STEP_SUMMARY
            fi
          done
          
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### üéØ ÌÖåÏä§Ìä∏ Í≤∞Í≥º" >> $GITHUB_STEP_SUMMARY
          
          if [ "$UPDATE_SUCCESS" = "true" ]; then
            echo "‚úÖ **README ÏÉùÏÑ±**: ÏÑ±Í≥µ" >> $GITHUB_STEP_SUMMARY
            if [ "$WOULD_COMMIT" = "true" ]; then
              echo "üìù **Î≥ÄÍ≤ΩÏÇ¨Ìï≠**: ÏûàÏùå (Ïã§Ï†ú Ïª§Î∞ãÏùÄ ÌïòÏßÄ ÏïäÏùå)" >> $GITHUB_STEP_SUMMARY
            else
              echo "‚ÑπÔ∏è **Î≥ÄÍ≤ΩÏÇ¨Ìï≠**: ÏóÜÏùå" >> $GITHUB_STEP_SUMMARY
            fi
          else
            echo "‚ùå **README ÏÉùÏÑ±**: Ïã§Ìå®" >> $GITHUB_STEP_SUMMARY
          fi
          
          if [ "$BACKUP_FILE" != "" ]; then
            echo "üìÅ **Î∞±ÏóÖ**: $BACKUP_FILE" >> $GITHUB_STEP_SUMMARY
          fi
          
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### üí° Ï∞∏Í≥†ÏÇ¨Ìï≠" >> $GITHUB_STEP_SUMMARY
          echo "- Ïù¥Í≤ÉÏùÄ PRÏóê ÏùòÌï¥ ÏûêÎèô Ïã§ÌñâÎêú **ÌÖåÏä§Ìä∏**ÏûÖÎãàÎã§" >> $GITHUB_STEP_SUMMARY
          echo "- Ïã§Ï†ú main Î∏åÎûúÏπòÎäî **Î≥ÄÍ≤ΩÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§**" >> $GITHUB_STEP_SUMMARY
          echo "- Ïä§ÌÅ¨Î¶ΩÌä∏ ÌååÏùºÎì§Ïù¥ Ï†ïÏÉÅ ÏûëÎèôÌïòÎäîÏßÄ ÌôïÏù∏ÌñàÏäµÎãàÎã§" >> $GITHUB_STEP_SUMMARY
          echo "- PRÏóê ÏûêÎèô ÎåìÍ∏ÄÎ°ú Í≤∞Í≥ºÍ∞Ä Ï∂îÍ∞ÄÎê©ÎãàÎã§" >> $GITHUB_STEP_SUMMARY
          
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "---" >> $GITHUB_STEP_SUMMARY
          echo "*üî• PR ÏûêÎèô Ìä∏Î¶¨Í±∞ ÎîîÎ≤ÑÍ∑∏ Î™®Îìú*" >> $GITHUB_STEP_SUMMARY